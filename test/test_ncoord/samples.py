"""
Data for testing repulsion taken from https://github.com/grimme-lab/mstore.
"""

import torch

from dxtb.typing import Molecule, Tensor, TypedDict

from ..molecules import merge_nested_dicts, mols


class Refs(TypedDict):
    """Format of reference records containing GFN1-xTB and GFN2-xTB reference values."""

    cn: Tensor
    """DFT-D3 coordination number."""

    dcndr: Tensor
    """Derivative of DFT-D3 coordination number w.r.t. positions."""


class Record(Molecule, Refs):
    """Store for molecular information and reference values"""


refs: dict[str, Refs] = {
    "SiH4": {
        "cn": torch.tensor(
            [
                +3.8902271062934779e00,
                +9.7265169803039875e-01,
                +9.7265169803039853e-01,
                +9.7265169803039875e-01,
                +9.7265169803039875e-01,
            ],
            dtype=torch.float64,
        ),
        "dcndr": torch.tensor(
            [
                [
                    -3.6082248300317588e-16,
                    -3.6082248300317588e-16,
                    -3.6082248300317588e-16,
                ],
                [
                    -1.0761613072315809e-01,
                    -1.0761613072315809e-01,
                    +1.0761613072315813e-01,
                ],
                [
                    +1.0761613072315841e-01,
                    +1.0761613072315841e-01,
                    +1.0761613072315841e-01,
                ],
                [
                    -1.0761613072315809e-01,
                    +1.0761613072315813e-01,
                    -1.0761613072315809e-01,
                ],
                [
                    +1.0761613072315813e-01,
                    -1.0761613072315809e-01,
                    -1.0761613072315809e-01,
                ],
                [
                    +1.0761613072315809e-01,
                    +1.0761613072315809e-01,
                    -1.0761613072315813e-01,
                ],
                [
                    -1.0767127553329162e-01,
                    -1.0767127553329162e-01,
                    +1.0767127553329166e-01,
                ],
                [
                    +2.7572405066766739e-05,
                    +2.7572405066766739e-05,
                    +0.0000000000000000e00,
                ],
                [
                    +0.0000000000000000e00,
                    +2.7572405066766739e-05,
                    -2.7572405066766739e-05,
                ],
                [
                    +2.7572405066766739e-05,
                    +0.0000000000000000e00,
                    -2.7572405066766739e-05,
                ],
                [
                    -1.0761613072315841e-01,
                    -1.0761613072315841e-01,
                    -1.0761613072315841e-01,
                ],
                [
                    -2.7572405066766739e-05,
                    -2.7572405066766739e-05,
                    +0.0000000000000000e00,
                ],
                [
                    +1.0767127553329194e-01,
                    +1.0767127553329194e-01,
                    +1.0767127553329194e-01,
                ],
                [
                    -2.7572405066766739e-05,
                    +0.0000000000000000e00,
                    -2.7572405066766739e-05,
                ],
                [
                    +0.0000000000000000e00,
                    -2.7572405066766739e-05,
                    -2.7572405066766739e-05,
                ],
                [
                    +1.0761613072315809e-01,
                    -1.0761613072315813e-01,
                    +1.0761613072315809e-01,
                ],
                [
                    +0.0000000000000000e00,
                    -2.7572405066766739e-05,
                    +2.7572405066766739e-05,
                ],
                [
                    +2.7572405066766739e-05,
                    +0.0000000000000000e00,
                    +2.7572405066766739e-05,
                ],
                [
                    -1.0767127553329162e-01,
                    +1.0767127553329166e-01,
                    -1.0767127553329162e-01,
                ],
                [
                    +2.7572405066766739e-05,
                    -2.7572405066766739e-05,
                    +0.0000000000000000e00,
                ],
                [
                    -1.0761613072315813e-01,
                    +1.0761613072315809e-01,
                    +1.0761613072315809e-01,
                ],
                [
                    -2.7572405066766739e-05,
                    +0.0000000000000000e00,
                    +2.7572405066766739e-05,
                ],
                [
                    +0.0000000000000000e00,
                    +2.7572405066766739e-05,
                    +2.7572405066766739e-05,
                ],
                [
                    -2.7572405066766739e-05,
                    +2.7572405066766739e-05,
                    +0.0000000000000000e00,
                ],
                [
                    +1.0767127553329166e-01,
                    -1.0767127553329162e-01,
                    -1.0767127553329162e-01,
                ],
            ],
            dtype=torch.float64,
        ),
    },
    "PbH4-BiH3": {
        "cn": torch.tensor(
            [
                3.9388208389,
                0.9832025766,
                0.9832026958,
                0.9832026958,
                0.9865897894,
                2.9714603424,
                0.9870455265,
                0.9870456457,
                0.9870455265,
            ]
        ),
        "dcndr": torch.tensor([], dtype=torch.float64),
    },
    "C6H5I-CH3SH": {
        "cn": torch.tensor(
            [
                3.1393690109,
                3.1313166618,
                3.1393768787,
                3.3153429031,
                3.1376547813,
                3.3148119450,
                1.5363609791,
                1.0035246611,
                1.0122337341,
                1.0036621094,
                1.0121959448,
                1.0036619902,
                2.1570565701,
                0.9981809855,
                3.9841127396,
                1.0146225691,
                1.0123561621,
                1.0085891485,
            ]
        ),
        "dcndr": torch.tensor([], dtype=torch.float64),
    },
    "MB16_43_01": {
        "cn": torch.tensor(
            [
                +4.1506636895139710e00,
                +9.7886802638978110e-01,
                +2.0108098563385948e00,
                +1.4786569782781820e00,
                +1.0357782244211671e00,
                +1.0120699431478060e00,
                +1.5032977712740094e00,
                +1.9985846827260885e00,
                +3.8918192753932415e00,
                +1.0432337336073976e00,
                +1.0152658445063574e00,
                +1.9931521322735404e00,
                +4.6352656088968294e00,
                +3.8731226063933479e00,
                +3.9931680067788431e00,
                +5.4506822690388841e00,
            ]
        ),
        "dcndr": torch.tensor(
            [
                [
                    +1.3653259654457006e00,
                    -1.8373906999542686e00,
                    +4.0600869388544936e-01,
                ],
                [
                    -9.6380447355688356e-04,
                    +5.4887423325690173e-04,
                    +3.9077668952050120e-04,
                ],
                [
                    +1.8796654177458495e-02,
                    -1.9528037486045393e-02,
                    -6.1251765421463052e-02,
                ],
                [
                    -5.6923568255907098e-01,
                    +4.6645071918388237e-01,
                    +5.6362379691118436e-01,
                ],
                [
                    +2.6484019090238097e-03,
                    +1.9643966609296272e-03,
                    -7.8488324574888350e-03,
                ],
                [
                    +1.5199106736220208e-04,
                    +6.0994013977115863e-04,
                    -3.4930908229310941e-04,
                ],
                [
                    -1.1865656787669390e-01,
                    +6.5598106955605362e-02,
                    -1.7849279447169575e-02,
                ],
                [
                    -4.7531600976545238e-04,
                    +4.8129717462184546e-04,
                    -3.9557712837973624e-04,
                ],
                [
                    -8.9401906870664738e-03,
                    +2.8226640038555884e-01,
                    -3.0357991483983804e-01,
                ],
                [
                    -6.7890694122193577e-05,
                    +4.8219257912872530e-05,
                    -3.8940944610567192e-05,
                ],
                [
                    +1.3156490623183855e-05,
                    +1.9856398718455750e-04,
                    -2.2636475293980412e-04,
                ],
                [
                    -2.8614661592606422e-02,
                    +6.7837637059387432e-02,
                    +9.3976051970613983e-03,
                ],
                [
                    -5.0376835460376812e-01,
                    +3.9114759810599453e-01,
                    +1.7681617319807252e-01,
                ],
                [
                    +1.2010906674620596e-01,
                    +1.0779487852045870e-01,
                    -4.8601823146955869e-01,
                ],
                [
                    +2.9282871807728277e-04,
                    +1.1545791252699077e-02,
                    -9.0642434623564201e-03,
                ],
                [
                    -2.7661559605780106e-01,
                    +4.6042631452305077e-01,
                    -2.6961458687519024e-01,
                ],
                [
                    +9.6380447355688356e-04,
                    -5.4887423325690173e-04,
                    -3.9077668952050120e-04,
                ],
                [
                    -2.1777216342147165e-01,
                    +1.9275082497184071e-02,
                    +1.1419121032818036e-01,
                ],
                [
                    +8.9756740571622705e-07,
                    -5.7569121476725795e-07,
                    -7.5618988941411686e-07,
                ],
                [
                    +1.4498625511953362e-04,
                    -5.5855417014824419e-05,
                    +3.7021992059795681e-06,
                ],
                [
                    +3.4245976675489711e-07,
                    -7.2379450622254855e-08,
                    -3.7813306455148199e-07,
                ],
                [
                    +2.0929513894070205e-07,
                    +8.4603366638676961e-08,
                    -1.6903518238102134e-07,
                ],
                [
                    +8.1940413542118414e-05,
                    -5.0316252897652504e-05,
                    -1.5517917069990026e-04,
                ],
                [
                    +1.1129966776848671e-06,
                    +3.4742243665762960e-06,
                    -1.1926234488708021e-05,
                ],
                [
                    +5.6136718390561330e-06,
                    -3.0657124254688505e-07,
                    -5.4795634595618883e-06,
                ],
                [
                    -3.5237016219611966e-07,
                    +5.5580062262853187e-07,
                    -2.3271642233723433e-06,
                ],
                [
                    +1.2277376377750266e-07,
                    +3.9996204413355065e-08,
                    -1.6768057800598461e-07,
                ],
                [
                    +7.0257828398749408e-03,
                    +6.7286365428245480e-03,
                    -3.3074933662829977e-03,
                ],
                [
                    +2.0891533524819711e-01,
                    -2.5618912029878725e-02,
                    -1.0927383749877206e-01,
                ],
                [
                    +1.8293189716097435e-06,
                    -6.1903653920301824e-07,
                    -1.7909412000853977e-06,
                ],
                [
                    +2.0799282314134658e-06,
                    +7.5186465931031028e-07,
                    -2.3222129458721579e-06,
                ],
                [
                    +6.2845854954829525e-04,
                    +2.6690608226705723e-04,
                    -1.0423086470789217e-03,
                ],
                [
                    -1.8796654177458495e-02,
                    +1.9528037486045393e-02,
                    +6.1251765421463052e-02,
                ],
                [
                    -8.9756740571622705e-07,
                    +5.7569121476725795e-07,
                    +7.5618988941411686e-07,
                ],
                [
                    +2.4494103762117463e-02,
                    -7.8983723602298134e-02,
                    -4.4612586857081186e-02,
                ],
                [
                    -3.5004091912223088e-06,
                    +3.0979609112569242e-06,
                    +5.8391339986117945e-06,
                ],
                [
                    +5.5224906921200953e-03,
                    +1.3223039199128567e-02,
                    -1.4854246415054787e-02,
                ],
                [
                    +5.7723463145136417e-07,
                    +8.2471059169819730e-06,
                    -1.9911939116627785e-07,
                ],
                [
                    -1.0500970848866804e-05,
                    +6.8210850687451690e-06,
                    +5.5442206195990782e-06,
                ],
                [
                    -8.3979700447502883e-06,
                    +8.5408923452609441e-06,
                    -1.2015017136036745e-06,
                ],
                [
                    -1.0120227691718537e-02,
                    +3.6109977209878186e-02,
                    +1.7812940561906106e-03,
                ],
                [
                    -1.1711861897477964e-06,
                    +8.8366757587314805e-07,
                    -6.7376854007012726e-08,
                ],
                [
                    -1.2689607883372319e-06,
                    +1.1638541696901679e-05,
                    -4.7875617480359187e-06,
                ],
                [
                    -1.9082921671565309e-05,
                    +3.8054304138949999e-05,
                    +2.2077971461568695e-05,
                ],
                [
                    -3.2789895460923911e-05,
                    +2.7260517788174614e-05,
                    +3.1460929226377776e-05,
                ],
                [
                    +1.3926523287983512e-04,
                    +8.1145829377666685e-03,
                    -3.8141135593125573e-03,
                ],
                [
                    -2.9736006905860813e-05,
                    +2.1348320616798507e-04,
                    -2.8063339724370087e-05,
                ],
                [
                    -1.1322091640648246e-03,
                    +1.6894837966544187e-03,
                    +2.1652780803047242e-04,
                ],
                [
                    +5.6923568255907098e-01,
                    -4.6645071918388237e-01,
                    -5.6362379691118436e-01,
                ],
                [
                    -1.4498625511953362e-04,
                    +5.5855417014824419e-05,
                    -3.7021992059795681e-06,
                ],
                [
                    +3.5004091912223088e-06,
                    -3.0979609112569242e-06,
                    -5.8391339986117945e-06,
                ],
                [
                    -3.5298465904736415e-01,
                    +3.0314982947770819e-01,
                    +7.1932946623999261e-01,
                ],
                [
                    +6.1075956346802827e-07,
                    -5.2669614305737042e-08,
                    -1.1708124791205846e-06,
                ],
                [
                    +2.8939197399079724e-07,
                    +3.0645026247555955e-07,
                    -4.3368141524912017e-07,
                ],
                [
                    -8.1538758627615430e-05,
                    +1.4709486200184172e-05,
                    -1.4219125998603065e-04,
                ],
                [
                    -1.7305122571038986e-06,
                    +2.0550383301254707e-06,
                    -4.2966642662697034e-06,
                ],
                [
                    +1.9613778461194219e-05,
                    +8.0788410260562549e-06,
                    -4.6864723151157300e-05,
                ],
                [
                    -3.8267060343408373e-07,
                    +2.4776764408526475e-07,
                    -5.6355354937678106e-07,
                ],
                [
                    +9.9887853295223590e-08,
                    +1.1684599854276883e-07,
                    -3.0139055564516644e-07,
                ],
                [
                    -4.7240861641860871e-04,
                    +1.0134429533097310e-02,
                    -3.6900729711501772e-03,
                ],
                [
                    -2.1547219283676541e-01,
                    +1.5213311132681745e-01,
                    -1.4989494582974097e-01,
                ],
                [
                    +6.1259651231216620e-06,
                    -1.8027534682370419e-06,
                    -1.1792392542723022e-05,
                ],
                [
                    +2.5615926507823594e-06,
                    +3.3829868630676220e-06,
                    -6.6176324112460909e-06,
                ],
                [
                    -1.1058564673202628e-04,
                    +9.5354939691385805e-04,
                    -1.8968770843557274e-03,
                ],
                [
                    -2.6484019090238097e-03,
                    -1.9643966609296272e-03,
                    +7.8488324574888350e-03,
                ],
                [
                    -3.4245976675489711e-07,
                    +7.2379450622254855e-08,
                    +3.7813306455148199e-07,
                ],
                [
                    -5.5224906921200953e-03,
                    -1.3223039199128567e-02,
                    +1.4854246415054787e-02,
                ],
                [
                    -6.1075956346802827e-07,
                    +5.2669614305737042e-08,
                    +1.1708124791205846e-06,
                ],
                [
                    +5.2189756762894078e-02,
                    -1.2035178901694003e-03,
                    -8.8515311818781292e-02,
                ],
                [
                    -9.2992746853089210e-06,
                    +7.0575898394185428e-05,
                    +4.3317840355385395e-05,
                ],
                [
                    -2.2762890719697705e-06,
                    +2.5527789186755933e-07,
                    +2.0706132051720231e-06,
                ],
                [
                    -1.6096335851064325e-05,
                    +7.9345376983857746e-06,
                    +4.7021330268060751e-06,
                ],
                [
                    -2.6382873061005910e-02,
                    +1.5950159525312854e-02,
                    +3.7606804940265075e-02,
                ],
                [
                    -1.3640006289183547e-06,
                    +4.8493516047093165e-07,
                    +3.9633563238793759e-07,
                ],
                [
                    -5.6045315856263626e-04,
                    +1.1316020034023201e-03,
                    +1.2538929921575287e-04,
                ],
                [
                    -1.4082094873781837e-05,
                    +1.3651029455916454e-05,
                    +2.1332643703309536e-05,
                ],
                [
                    -6.1662275389545393e-06,
                    +1.4667327408268759e-06,
                    +7.8793659261637312e-06,
                ],
                [
                    -1.2493406859818449e-02,
                    -7.3394340331652524e-03,
                    +2.3625623435918112e-02,
                ],
                [
                    -2.9978494114017546e-03,
                    +5.6294071525768404e-03,
                    +3.2026912164913163e-03,
                ],
                [
                    -1.5340442289812023e-03,
                    +9.2472564169425269e-04,
                    +1.1704761769545133e-03,
                ],
                [
                    -1.5199106736220208e-04,
                    -6.0994013977115863e-04,
                    +3.4930908229310941e-04,
                ],
                [
                    -2.0929513894070205e-07,
                    -8.4603366638676961e-08,
                    +1.6903518238102134e-07,
                ],
                [
                    -5.7723463145136417e-07,
                    -8.2471059169819730e-06,
                    +1.9911939116627785e-07,
                ],
                [
                    -2.8939197399079724e-07,
                    -3.0645026247555955e-07,
                    +4.3368141524912017e-07,
                ],
                [
                    +9.2992746853089210e-06,
                    -7.0575898394185428e-05,
                    -4.3317840355385395e-05,
                ],
                [
                    +6.1012166943412244e-02,
                    +3.8166143060328270e-02,
                    +1.1401370697734923e-02,
                ],
                [
                    -7.6213302661030632e-07,
                    -5.1955661304516499e-07,
                    +3.8995318434984422e-07,
                ],
                [
                    -1.3681382022669277e-05,
                    -2.1032412341519047e-06,
                    -1.4466357789255030e-06,
                ],
                [
                    -4.2531454519544329e-03,
                    -8.4276288351026584e-03,
                    +9.7193518793014860e-04,
                ],
                [
                    -5.8472698426542014e-07,
                    -1.0502488529324491e-07,
                    -1.9023426840221543e-08,
                ],
                [
                    -4.6429305052955635e-04,
                    -3.7237285466693335e-04,
                    -9.3885767514240246e-04,
                ],
                [
                    -2.6457918335967789e-04,
                    +1.8085511024175722e-06,
                    +2.7988155484042718e-04,
                ],
                [
                    -6.7127171049637205e-06,
                    -3.8878207497077096e-06,
                    +6.0557903409764382e-06,
                ],
                [
                    -2.5088098206320511e-05,
                    -2.7711786634101229e-04,
                    -4.1349583403698649e-05,
                ],
                [
                    -3.4460242409823802e-02,
                    -2.0060503048643000e-02,
                    -1.6465363584465008e-02,
                ],
                [
                    -2.1379310075978670e-02,
                    -8.3345591654834430e-03,
                    +4.4806102402595313e-03,
                ],
                [
                    +1.1865656787669390e-01,
                    -6.5598106955605362e-02,
                    +1.7849279447169575e-02,
                ],
                [
                    -8.1940413542118414e-05,
                    +5.0316252897652504e-05,
                    +1.5517917069990026e-04,
                ],
                [
                    +1.0500970848866804e-05,
                    -6.8210850687451690e-06,
                    -5.5442206195990782e-06,
                ],
                [
                    +8.1538758627615430e-05,
                    -1.4709486200184172e-05,
                    +1.4219125998603065e-04,
                ],
                [
                    +2.2762890719697705e-06,
                    -2.5527789186755933e-07,
                    -2.0706132051720231e-06,
                ],
                [
                    +7.6213302661030632e-07,
                    +5.1955661304516499e-07,
                    -3.8995318434984422e-07,
                ],
                [
                    -6.5054417649071827e-01,
                    -8.3212331669972961e-01,
                    +2.1686446459065045e-01,
                ],
                [
                    -5.4088060717523309e-05,
                    +1.6466431315889966e-04,
                    -2.0799250555520886e-04,
                ],
                [
                    +3.5267521063846673e-04,
                    +5.6121399159101978e-05,
                    -2.2059717614408104e-04,
                ],
                [
                    -8.6292598902636861e-06,
                    +8.4062160669046690e-06,
                    -1.1071570293316754e-05,
                ],
                [
                    +5.6427628685070917e-07,
                    +3.6666889013287590e-07,
                    -6.6794169729300220e-07,
                ],
                [
                    +4.1973543018149501e-03,
                    +1.0682861896782121e-02,
                    +4.0565844624551118e-03,
                ],
                [
                    +5.4369547097324174e-02,
                    +1.5620028668840297e-01,
                    +4.2584947838006598e-01,
                ],
                [
                    +3.5477503215616413e-05,
                    -9.0992510851986061e-06,
                    -2.5088849707029545e-05,
                ],
                [
                    +2.4434218340125121e-05,
                    +1.7453158390004556e-05,
                    -2.0411613369203330e-05,
                ],
                [
                    +4.7295713558897906e-01,
                    +7.3057131260522012e-01,
                    -6.6442334286725180e-01,
                ],
                [
                    +4.7531600976545238e-04,
                    -4.8129717462184546e-04,
                    +3.9557712837973624e-04,
                ],
                [
                    -1.1129966776848671e-06,
                    -3.4742243665762960e-06,
                    +1.1926234488708021e-05,
                ],
                [
                    +8.3979700447502883e-06,
                    -8.5408923452609441e-06,
                    +1.2015017136036745e-06,
                ],
                [
                    +1.7305122571038986e-06,
                    -2.0550383301254707e-06,
                    +4.2966642662697034e-06,
                ],
                [
                    +1.6096335851064325e-05,
                    -7.9345376983857746e-06,
                    -4.7021330268060751e-06,
                ],
                [
                    +1.3681382022669277e-05,
                    +2.1032412341519047e-06,
                    +1.4466357789255030e-06,
                ],
                [
                    +5.4088060717523309e-05,
                    -1.6466431315889966e-04,
                    +2.0799250555520886e-04,
                ],
                [
                    +4.8997341224538325e-02,
                    +2.3701327299647214e-02,
                    -3.4443692513233815e-02,
                ],
                [
                    +1.0034323237233956e-03,
                    -4.4452509038837292e-04,
                    +2.1560444951238306e-04,
                ],
                [
                    -6.8449341046968440e-02,
                    -1.9937014460464149e-02,
                    +1.9387940345126423e-02,
                ],
                [
                    +4.7946638148805471e-05,
                    +5.5093037673129919e-07,
                    -1.5090300271974426e-05,
                ],
                [
                    +2.4046302146703146e-03,
                    +1.0179175919362191e-03,
                    +4.9519669828402470e-03,
                ],
                [
                    +1.2412314006942198e-04,
                    -2.2137238246483436e-04,
                    +5.8276067309172416e-04,
                ],
                [
                    +7.7957792517999576e-05,
                    -5.3153694365504213e-05,
                    -9.8122751472179160e-07,
                ],
                [
                    +2.2482094051138176e-03,
                    +8.7151093281213841e-05,
                    +1.3241572615083497e-05,
                ],
                [
                    +1.2977503034205480e-02,
                    -3.4850183482715764e-03,
                    +8.6905114806790085e-03,
                ],
                [
                    +8.9401906870664738e-03,
                    -2.8226640038555884e-01,
                    +3.0357991483983804e-01,
                ],
                [
                    -5.6136718390561330e-06,
                    +3.0657124254688505e-07,
                    +5.4795634595618883e-06,
                ],
                [
                    +1.0120227691718537e-02,
                    -3.6109977209878186e-02,
                    -1.7812940561906106e-03,
                ],
                [
                    -1.9613778461194219e-05,
                    -8.0788410260562549e-06,
                    +4.6864723151157300e-05,
                ],
                [
                    +2.6382873061005910e-02,
                    -1.5950159525312854e-02,
                    -3.7606804940265075e-02,
                ],
                [
                    +4.2531454519544329e-03,
                    +8.4276288351026584e-03,
                    -9.7193518793014860e-04,
                ],
                [
                    -3.5267521063846673e-04,
                    -5.6121399159101978e-05,
                    +2.2059717614408104e-04,
                ],
                [
                    -1.0034323237233956e-03,
                    +4.4452509038837292e-04,
                    -2.1560444951238306e-04,
                ],
                [
                    -6.0539245065009510e-02,
                    +1.9638103446158633e-01,
                    -1.8696628561983783e-01,
                ],
                [
                    -2.1075173624625149e-05,
                    +5.6969493250187869e-06,
                    -2.0594435864625648e-06,
                ],
                [
                    +1.2179040684822029e-03,
                    +6.3178373423167875e-03,
                    -7.7288342021884261e-03,
                ],
                [
                    -4.2733609111418776e-03,
                    +5.5240231836345393e-03,
                    +6.8123439967603559e-03,
                ],
                [
                    -1.0011223880389668e-03,
                    +2.2364315182420464e-05,
                    +1.1924121320835322e-03,
                ],
                [
                    +1.9305812979637176e-02,
                    -3.3038966291547345e-02,
                    -1.9172619866899103e-02,
                ],
                [
                    +1.3314809182749708e-02,
                    +1.4049379998792066e-01,
                    -6.0639711802168338e-02,
                ],
                [
                    -1.6318824600137345e-02,
                    +9.8124869157830003e-03,
                    +3.2275371371416959e-03,
                ],
                [
                    +6.7890694122193577e-05,
                    -4.8219257912872530e-05,
                    +3.8940944610567192e-05,
                ],
                [
                    +3.5237016219611966e-07,
                    -5.5580062262853187e-07,
                    +2.3271642233723433e-06,
                ],
                [
                    +1.1711861897477964e-06,
                    -8.8366757587314805e-07,
                    +6.7376854007012726e-08,
                ],
                [
                    +3.8267060343408373e-07,
                    -2.4776764408526475e-07,
                    +5.6355354937678106e-07,
                ],
                [
                    +1.3640006289183547e-06,
                    -4.8493516047093165e-07,
                    -3.9633563238793759e-07,
                ],
                [
                    +5.8472698426542014e-07,
                    +1.0502488529324491e-07,
                    +1.9023426840221543e-08,
                ],
                [
                    +8.6292598902636861e-06,
                    -8.4062160669046690e-06,
                    +1.1071570293316754e-05,
                ],
                [
                    +6.8449341046968440e-02,
                    +1.9937014460464149e-02,
                    -1.9387940345126423e-02,
                ],
                [
                    +2.1075173624625149e-05,
                    -5.6969493250187869e-06,
                    +2.0594435864625648e-06,
                ],
                [
                    -1.9887476240073618e-01,
                    -1.3565831903919945e-02,
                    -1.9364454664717513e-02,
                ],
                [
                    +1.0698731755699063e-06,
                    +7.8259727114701261e-08,
                    -3.2929854730222092e-07,
                ],
                [
                    +1.5676709449088193e-04,
                    +5.8431206060085163e-05,
                    +1.8214351851368962e-04,
                ],
                [
                    +3.5985982323066167e-05,
                    -2.2159217721418150e-05,
                    +6.8126811384073500e-05,
                ],
                [
                    +5.3477940404575895e-06,
                    -2.6068107919800858e-06,
                    -3.5642790237339450e-07,
                ],
                [
                    +2.1604592777002368e-05,
                    +2.0770278492468719e-06,
                    -1.2921164746432922e-06,
                ],
                [
                    +1.3010319593475511e-01,
                    -6.3426134522446952e-03,
                    +3.8449449781958939e-02,
                ],
                [
                    -1.3156490623183855e-05,
                    -1.9856398718455750e-04,
                    +2.2636475293980412e-04,
                ],
                [
                    -1.2277376377750266e-07,
                    -3.9996204413355065e-08,
                    +1.6768057800598461e-07,
                ],
                [
                    +1.2689607883372319e-06,
                    -1.1638541696901679e-05,
                    +4.7875617480359187e-06,
                ],
                [
                    -9.9887853295223590e-08,
                    -1.1684599854276883e-07,
                    +3.0139055564516644e-07,
                ],
                [
                    +5.6045315856263626e-04,
                    -1.1316020034023201e-03,
                    -1.2538929921575287e-04,
                ],
                [
                    +4.6429305052955635e-04,
                    +3.7237285466693335e-04,
                    +9.3885767514240246e-04,
                ],
                [
                    -5.6427628685070917e-07,
                    -3.6666889013287590e-07,
                    +6.6794169729300220e-07,
                ],
                [
                    -4.7946638148805471e-05,
                    -5.5093037673129919e-07,
                    +1.5090300271974426e-05,
                ],
                [
                    -1.2179040684822029e-03,
                    -6.3178373423167875e-03,
                    +7.7288342021884261e-03,
                ],
                [
                    -1.0698731755699063e-06,
                    -7.8259727114701261e-08,
                    +3.2929854730222092e-07,
                ],
                [
                    +2.6048410414645000e-02,
                    +9.4316544440210016e-03,
                    -7.6108957302872954e-02,
                ],
                [
                    -2.1511631198111984e-05,
                    +7.1541789988816345e-06,
                    +4.9437515328783892e-05,
                ],
                [
                    -2.5573879722085563e-06,
                    -1.3209445702027611e-06,
                    +4.4096024826334134e-06,
                ],
                [
                    +1.7437889328351364e-04,
                    -1.0311542527957789e-03,
                    +3.9536317375062487e-04,
                ],
                [
                    -5.3802664964175536e-03,
                    +3.5937033991322721e-03,
                    +4.4665780196689826e-02,
                ],
                [
                    -2.0563604953887482e-02,
                    -4.7116151036556055e-03,
                    +2.2203955310167948e-02,
                ],
                [
                    +2.8614661592606422e-02,
                    -6.7837637059387432e-02,
                    -9.3976051970613983e-03,
                ],
                [
                    -7.0257828398749408e-03,
                    -6.7286365428245480e-03,
                    +3.3074933662829977e-03,
                ],
                [
                    +1.9082921671565309e-05,
                    -3.8054304138949999e-05,
                    -2.2077971461568695e-05,
                ],
                [
                    +4.7240861641860871e-04,
                    -1.0134429533097310e-02,
                    +3.6900729711501772e-03,
                ],
                [
                    +1.4082094873781837e-05,
                    -1.3651029455916454e-05,
                    -2.1332643703309536e-05,
                ],
                [
                    +2.6457918335967789e-04,
                    -1.8085511024175722e-06,
                    -2.7988155484042718e-04,
                ],
                [
                    -4.1973543018149501e-03,
                    -1.0682861896782121e-02,
                    -4.0565844624551118e-03,
                ],
                [
                    -2.4046302146703146e-03,
                    -1.0179175919362191e-03,
                    -4.9519669828402470e-03,
                ],
                [
                    +4.2733609111418776e-03,
                    -5.5240231836345393e-03,
                    -6.8123439967603559e-03,
                ],
                [
                    -1.5676709449088193e-04,
                    -5.8431206060085163e-05,
                    -1.8214351851368962e-04,
                ],
                [
                    +2.1511631198111984e-05,
                    -7.1541789988816345e-06,
                    -4.9437515328783892e-05,
                ],
                [
                    +8.7823113248959569e-02,
                    +4.1084978494191743e-01,
                    +5.5665335083086631e-02,
                ],
                [
                    -1.0979728305108775e-01,
                    -2.7230209249798426e-01,
                    +4.3598751543336957e-02,
                ],
                [
                    +1.1206916281871411e-04,
                    -1.5964003735912519e-04,
                    -1.5744794871194905e-04,
                ],
                [
                    +3.9905428675390611e-03,
                    -1.2251170013360499e-03,
                    -7.3445136590134900e-03,
                ],
                [
                    -2.0235947286485396e-03,
                    -3.5118330327819601e-02,
                    -7.2986317513166435e-02,
                ],
                [
                    +5.0376835460376812e-01,
                    -3.9114759810599453e-01,
                    -1.7681617319807252e-01,
                ],
                [
                    -2.0891533524819711e-01,
                    +2.5618912029878725e-02,
                    +1.0927383749877206e-01,
                ],
                [
                    +3.2789895460923911e-05,
                    -2.7260517788174614e-05,
                    -3.1460929226377776e-05,
                ],
                [
                    +2.1547219283676541e-01,
                    -1.5213311132681745e-01,
                    +1.4989494582974097e-01,
                ],
                [
                    +6.1662275389545393e-06,
                    -1.4667327408268759e-06,
                    -7.8793659261637312e-06,
                ],
                [
                    +6.7127171049637205e-06,
                    +3.8878207497077096e-06,
                    -6.0557903409764382e-06,
                ],
                [
                    -5.4369547097324174e-02,
                    -1.5620028668840297e-01,
                    -4.2584947838006598e-01,
                ],
                [
                    -1.2412314006942198e-04,
                    +2.2137238246483436e-04,
                    -5.8276067309172416e-04,
                ],
                [
                    +1.0011223880389668e-03,
                    -2.2364315182420464e-05,
                    -1.1924121320835322e-03,
                ],
                [
                    -3.5985982323066167e-05,
                    +2.2159217721418150e-05,
                    -6.8126811384073500e-05,
                ],
                [
                    +2.5573879722085563e-06,
                    +1.3209445702027611e-06,
                    -4.4096024826334134e-06,
                ],
                [
                    +1.0979728305108775e-01,
                    +2.7230209249798426e-01,
                    -4.3598751543336957e-02,
                ],
                [
                    -7.7748169134523626e-01,
                    +1.3607147540844722e-01,
                    +1.1033078972598378e00,
                ],
                [
                    +8.3146367638566393e-05,
                    -3.4660485114322943e-05,
                    -9.5188626717804793e-05,
                ],
                [
                    +1.0443322774496291e-04,
                    +6.0377255606699294e-05,
                    -1.4433376304255927e-04,
                ],
                [
                    +2.1065192411002920e-01,
                    +2.6526515061461775e-01,
                    -7.1407964977257943e-01,
                ],
                [
                    -1.2010906674620596e-01,
                    -1.0779487852045870e-01,
                    +4.8601823146955869e-01,
                ],
                [
                    -1.8293189716097435e-06,
                    +6.1903653920301824e-07,
                    +1.7909412000853977e-06,
                ],
                [
                    -1.3926523287983512e-04,
                    -8.1145829377666685e-03,
                    +3.8141135593125573e-03,
                ],
                [
                    -6.1259651231216620e-06,
                    +1.8027534682370419e-06,
                    +1.1792392542723022e-05,
                ],
                [
                    +1.2493406859818449e-02,
                    +7.3394340331652524e-03,
                    -2.3625623435918112e-02,
                ],
                [
                    +2.5088098206320511e-05,
                    +2.7711786634101229e-04,
                    +4.1349583403698649e-05,
                ],
                [
                    -3.5477503215616413e-05,
                    +9.0992510851986061e-06,
                    +2.5088849707029545e-05,
                ],
                [
                    -7.7957792517999576e-05,
                    +5.3153694365504213e-05,
                    +9.8122751472179160e-07,
                ],
                [
                    -1.9305812979637176e-02,
                    +3.3038966291547345e-02,
                    +1.9172619866899103e-02,
                ],
                [
                    -5.3477940404575895e-06,
                    +2.6068107919800858e-06,
                    +3.5642790237339450e-07,
                ],
                [
                    -1.7437889328351364e-04,
                    +1.0311542527957789e-03,
                    -3.9536317375062487e-04,
                ],
                [
                    -1.1206916281871411e-04,
                    +1.5964003735912519e-04,
                    +1.5744794871194905e-04,
                ],
                [
                    -8.3146367638566393e-05,
                    +3.4660485114322943e-05,
                    +9.5188626717804793e-05,
                ],
                [
                    +1.9294810514573751e-01,
                    -2.4394326728386997e-02,
                    -5.1105874059071632e-01,
                ],
                [
                    -9.6996622390820939e-03,
                    +4.5882329363337276e-02,
                    +1.1289678192543059e-03,
                ],
                [
                    -5.5716460108347632e-02,
                    +5.2473204310702126e-02,
                    +2.4611798487660042e-02,
                ],
                [
                    -2.9282871807728277e-04,
                    -1.1545791252699077e-02,
                    +9.0642434623564201e-03,
                ],
                [
                    -2.0799282314134658e-06,
                    -7.5186465931031028e-07,
                    +2.3222129458721579e-06,
                ],
                [
                    +2.9736006905860813e-05,
                    -2.1348320616798507e-04,
                    +2.8063339724370087e-05,
                ],
                [
                    -2.5615926507823594e-06,
                    -3.3829868630676220e-06,
                    +6.6176324112460909e-06,
                ],
                [
                    +2.9978494114017546e-03,
                    -5.6294071525768404e-03,
                    -3.2026912164913163e-03,
                ],
                [
                    +3.4460242409823802e-02,
                    +2.0060503048643000e-02,
                    +1.6465363584465008e-02,
                ],
                [
                    -2.4434218340125121e-05,
                    -1.7453158390004556e-05,
                    +2.0411613369203330e-05,
                ],
                [
                    -2.2482094051138176e-03,
                    -8.7151093281213841e-05,
                    -1.3241572615083497e-05,
                ],
                [
                    -1.3314809182749708e-02,
                    -1.4049379998792066e-01,
                    +6.0639711802168338e-02,
                ],
                [
                    -2.1604592777002368e-05,
                    -2.0770278492468719e-06,
                    +1.2921164746432922e-06,
                ],
                [
                    +5.3802664964175536e-03,
                    -3.5937033991322721e-03,
                    -4.4665780196689826e-02,
                ],
                [
                    -3.9905428675390611e-03,
                    +1.2251170013360499e-03,
                    +7.3445136590134900e-03,
                ],
                [
                    -1.0443322774496291e-04,
                    -6.0377255606699294e-05,
                    +1.4433376304255927e-04,
                ],
                [
                    +9.6996622390820939e-03,
                    -4.5882329363337276e-02,
                    -1.1289678192543059e-03,
                ],
                [
                    +3.8949760023626580e-02,
                    +2.0735430487604908e-01,
                    -8.3894006828195644e-02,
                ],
                [
                    -7.1516012854033487e-02,
                    -2.1110217177544494e-02,
                    +3.9187814447275038e-02,
                ],
                [
                    +2.7661559605780106e-01,
                    -4.6042631452305077e-01,
                    +2.6961458687519024e-01,
                ],
                [
                    -6.2845854954829525e-04,
                    -2.6690608226705723e-04,
                    +1.0423086470789217e-03,
                ],
                [
                    +1.1322091640648246e-03,
                    -1.6894837966544187e-03,
                    -2.1652780803047242e-04,
                ],
                [
                    +1.1058564673202628e-04,
                    -9.5354939691385805e-04,
                    +1.8968770843557274e-03,
                ],
                [
                    +1.5340442289812023e-03,
                    -9.2472564169425269e-04,
                    -1.1704761769545133e-03,
                ],
                [
                    +2.1379310075978670e-02,
                    +8.3345591654834430e-03,
                    -4.4806102402595313e-03,
                ],
                [
                    -4.7295713558897906e-01,
                    -7.3057131260522012e-01,
                    +6.6442334286725180e-01,
                ],
                [
                    -1.2977503034205480e-02,
                    +3.4850183482715764e-03,
                    -8.6905114806790085e-03,
                ],
                [
                    +1.6318824600137345e-02,
                    -9.8124869157830003e-03,
                    -3.2275371371416959e-03,
                ],
                [
                    -1.3010319593475511e-01,
                    +6.3426134522446952e-03,
                    -3.8449449781958939e-02,
                ],
                [
                    +2.0563604953887482e-02,
                    +4.7116151036556055e-03,
                    -2.2203955310167948e-02,
                ],
                [
                    +2.0235947286485396e-03,
                    +3.5118330327819601e-02,
                    +7.2986317513166435e-02,
                ],
                [
                    -2.1065192411002920e-01,
                    -2.6526515061461775e-01,
                    +7.1407964977257943e-01,
                ],
                [
                    +5.5716460108347632e-02,
                    -5.2473204310702126e-02,
                    -2.4611798487660042e-02,
                ],
                [
                    +7.1516012854033487e-02,
                    +2.1110217177544494e-02,
                    -3.9187814447275038e-02,
                ],
                [
                    +3.6040797479890491e-01,
                    +1.4432807803118839e00,
                    -1.5818044018894950e00,
                ],
            ],
            dtype=torch.float64,
        ),
    },
}


samples: dict[str, Record] = merge_nested_dicts(mols, refs)
