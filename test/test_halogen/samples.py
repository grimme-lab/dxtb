# This file is part of dxtb.
#
# SPDX-Identifier: Apache-2.0
# Copyright (C) 2024 Grimme Group
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
"""
Samples for test of halogen bond correction.
"""

from __future__ import annotations

import torch

from dxtb._src.typing import Molecule, Tensor, TypedDict

from ..molecules import merge_nested_dicts, mols


class Refs(TypedDict):
    """Format of reference records."""

    energy: Tensor
    """Reference value for energy from halogen bond correction."""

    gradient: Tensor
    """Reference nuclear gradient."""

    hessian: Tensor
    """Reference nuclear Hessian."""


class Record(Molecule, Refs):
    """Store for molecular information and reference values"""


refs: dict[str, Refs] = {
    "LiH": {
        "energy": torch.tensor(0.0, dtype=torch.double),
        "gradient": torch.zeros(2, 3, dtype=torch.double),
        "hessian": torch.zeros(2 * 3 * 2 * 3, dtype=torch.double),
    },
    "SiH4": {
        "energy": torch.tensor(0.0, dtype=torch.double),
        "gradient": torch.zeros(5, 3, dtype=torch.double),
        "hessian": torch.zeros(5 * 3 * 5 * 3, dtype=torch.double),
    },
    "MB16_43_01": {
        "energy": torch.tensor(0.0, dtype=torch.double),
        "gradient": torch.zeros(16, 3, dtype=torch.double),
        "hessian": torch.zeros(16 * 3 * 16 * 3, dtype=torch.double),
    },
    "br2nh3": {
        "energy": torch.tensor(2.4763110097465683e-3),
        "gradient": torch.tensor(
            [
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    -1.3105758671001298e-02,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +1.3105758671001298e-02,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                ],
            ]
        ),
        "hessian": torch.tensor(
            [
                -3.88715123575937e-04,
                +7.25531028614488e-04,
                -3.36815905038551e-04,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +7.25531023311730e-04,
                -3.95181409548797e-03,
                +3.22628307217624e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -3.36815903348829e-04,
                +3.22628307916872e-03,
                -2.88946717581989e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -3.88715123575937e-04,
                +7.25531028614488e-04,
                -3.36815905038551e-04,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +7.25531023311730e-04,
                -3.95181409548797e-03,
                +3.22628307217624e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -3.36815903348829e-04,
                +3.22628307916872e-03,
                -2.88946717581989e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -9.54097911787244e-14,
                +9.54097911787244e-14,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -2.16840434497101e-15,
                +2.81182474925253e-02,
                -2.81182474925340e-02,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -2.16840434497101e-15,
                -2.81182474927161e-02,
                +2.81182474927248e-02,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
            ],
            dtype=torch.double,
        ),
    },
    "br2nh2o": {
        "energy": torch.tensor(1.0010592532310653e-003),
        "gradient": torch.tensor([]),
        "hessian": torch.tensor([], dtype=torch.double),
    },
    "br2och2": {
        "energy": torch.tensor(-6.7587305781592112e-4),
        "gradient": torch.tensor(
            [
                [
                    +4.70713652397321e-05,
                    -2.13179671555900e-05,
                    +0.00000000000000e00,
                ],
                [
                    +2.48280052870633e-03,
                    +4.37000632260397e-03,
                    +0.00000000000000e00,
                ],
                [
                    -2.52987189394606e-03,
                    -4.34868835544838e-03,
                    +0.00000000000000e00,
                ],
                [
                    +0.00000000000000e00,
                    +0.00000000000000e00,
                    +0.00000000000000e00,
                ],
                [
                    +0.00000000000000e00,
                    +0.00000000000000e00,
                    +0.00000000000000e00,
                ],
                [
                    +0.00000000000000e00,
                    +0.00000000000000e00,
                    +0.00000000000000e00,
                ],
            ]
        ),
        "hessian": torch.tensor(
            [
                +9.58107228342213e-05,
                -3.42671782132490e-04,
                +2.46861059300437e-04,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -3.14507386578238e-05,
                -2.29492762974549e-04,
                +2.60943501632915e-04,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -3.42671777431931e-04,
                +4.60002568542688e-03,
                -4.25735390799549e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +1.43250678381023e-04,
                +8.07284739312662e-03,
                -8.21609807151197e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +2.46861056942297e-04,
                -4.25735391500377e-03,
                +4.01049285806256e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -1.11799942004902e-04,
                -7.84335463822720e-03,
                +7.95515458023102e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -3.14507387849466e-05,
                +1.43250681676997e-04,
                -1.11799942892864e-04,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +8.83586794930922e-06,
                +1.09341817149979e-04,
                -1.18177685098746e-04,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -2.29492770081224e-04,
                +8.07284743749651e-03,
                -7.84335466741826e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +1.09341819877289e-04,
                +1.17643324114595e-02,
                -1.18736742313330e-02,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +2.60943507677885e-04,
                -8.21609812069355e-03,
                +7.95515461301513e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -1.18177688236969e-04,
                -1.18736742371140e-02,
                +1.19918519253526e-02,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +1.07938837544718e-04,
                -1.98139111130482e-04,
                +9.02002735857633e-05,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -1.98139112149849e-04,
                -6.02773682423933e-04,
                +8.00912794573782e-04,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +9.02002742561627e-05,
                +8.00912796263550e-04,
                -8.91113070519713e-04,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
            ],
            dtype=torch.double,
        ),
    },
    "finch": {
        "energy": torch.tensor(1.1857937381795408e-2),
        "gradient": torch.tensor(
            [
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    -2.0420986552797993e-02,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +2.0420986552797993e-02,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                ],
            ]
        ),
        "hessian": torch.tensor(
            [
                -2.63176464411223e-03,
                +4.58979098676705e-03,
                -1.95802634265483e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +4.58979096771599e-03,
                -1.21370236734171e-02,
                +7.54723270570113e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -1.95802634037479e-03,
                +7.54723272703223e-03,
                -5.58920638665744e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -2.63176464411223e-03,
                +4.58979098676705e-03,
                -1.95802634265483e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +4.58979096771599e-03,
                -1.21370236734171e-02,
                +7.54723270570113e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -1.95802634037479e-03,
                +7.54723272703223e-03,
                -5.58920638665744e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -6.93889390390723e-14,
                +6.93889390390723e-14,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -1.73472347597681e-14,
                +5.98030189398815e-03,
                -5.98030189397081e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                -5.98030189398815e-03,
                +5.98030189398815e-03,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
                +0.00000000000000e00,
            ],
            dtype=torch.double,
        ),
    },
    "tmpda": {
        "energy": torch.tensor(7.6976121430560651e-002),
        "gradient": torch.tensor([]),
        "hessian": torch.tensor([], dtype=torch.double),
    },
    "tmpda_mod": {
        "energy": torch.tensor(3.1574395196210699e-003),
        "gradient": torch.tensor([]),
        "hessian": torch.tensor([], dtype=torch.double),
    },
    "LYS_xao": {
        "energy": torch.tensor(0.0),
        "gradient": torch.zeros(33, 3, dtype=torch.double),
        "hessian": torch.zeros(33 * 3 * 33 * 3, dtype=torch.double),
    },
}


samples: dict[str, Record] = merge_nested_dicts(mols, refs)
